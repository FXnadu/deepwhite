/*!
 * DeepWhite Theme for Typora
 * 基于 ladder.css，添加自定义样式
 * 
 * 结构：
 * 1. 字体定义
 * 2. CSS 变量
 * 3. Tailwind Reset
 * 4. Ladder 基础样式
 * 5. DeepWhite 自定义样式
 */

/* =========================
   1. 字体定义
   ========================= */
@font-face {
  font-family: "LXGWWenKai-Regular";
  font-display: block;
  src: url("deepwhite-fonts/LXGWWenKai-Regular.ttf") format("truetype");
}

@font-face {
  font-family: "LXGWWenKai-Medium";
  font-display: block;
  src: url("deepwhite-fonts/LXGWWenKai-Medium.ttf") format("truetype");
}



/* =========================
   2. CSS 变量
   ========================= */
:root {
  /* Slate 灰度色阶 */
  --theme-0: #fff;
  --theme-50: #f8fafc;
  --theme-100: #f1f5f9;
  --theme-200: #e2e8f0;
  --theme-300: #cbd5e1;
  --theme-400: #94a3b8;
  --theme-500: #64748b;
  --theme-600: #475569;
  --theme-700: #334155;
  --theme-800: #1e293b;
  --theme-900: #0f172a;

  /* Tailwind 变量 */
  --tw-primary: #62bbf3;
  --tw-prose-body: var(--theme-700);
  --tw-prose-headings: var(--theme-900);
  --tw-prose-lead: var(--theme-600);
  --tw-prose-links: var(--theme-900);
  --tw-prose-bold: var(--theme-900);
  --tw-prose-counters: var(--theme-500);
  --tw-prose-bullets: var(--theme-300);
  --tw-prose-hr: var(--theme-200);
  --tw-prose-quotes: var(--theme-900);
  --tw-prose-quote-borders: var(--theme-200);
  --tw-prose-captions: var(--theme-500);
  --tw-prose-code: var(--theme-900);
  --tw-prose-pre-code: var(--theme-100);
  --tw-prose-pre-bg: var(--theme-800);
  --tw-prose-th-borders: var(--theme-300);
  --tw-prose-td-borders: var(--theme-200);
  --tw-prose-bg: var(--theme-0);
  --tw-prose-meta: var(--theme-500);
  --tw-prose-meta-bg: var(--theme-100);

  --tw-prose-invert-body: var(--theme-300);
  --tw-prose-invert-headings: var(--theme-0);
  --tw-prose-invert-lead: var(--theme-400);
  --tw-prose-invert-links: var(--theme-0);
  --tw-prose-invert-bold: var(--theme-0);
  --tw-prose-invert-counters: var(--theme-400);
  --tw-prose-invert-bullets: var(--theme-600);
  --tw-prose-invert-hr: var(--theme-700);
  --tw-prose-invert-quotes: var(--theme-100);
  --tw-prose-invert-quote-borders: var(--theme-700);
  --tw-prose-invert-captions: var(--theme-400);
  --tw-prose-invert-code: var(--theme-0);
  --tw-prose-invert-pre-bg: var(--theme-900);
  --tw-prose-invert-th-borders: var(--theme-600);
  --tw-prose-invert-td-borders: var(--theme-700);
  --tw-prose-invert-bg: var(--theme-800);
  --tw-prose-invert-meta: var(--theme-400);
  --tw-prose-invert-meta-bg: var(--theme-700);

  --tw-highlight-color: #fde047;
  --tw-drop-shadow-md: drop-shadow(0 4px 3px rgb(0 0 0 / 0.07))
    drop-shadow(0 2px 2px rgb(0 0 0 / 0.06));
  --tw-button-hover-bg: var(--theme-100);
  --tw-button-hover-bg-inverted: var(--theme-700);

  /* Typora 变量 */
  --background: var(--tw-prose-bg);
  --bg-color: var(--tw-prose-bg);
  --text-color: var(--tw-prose-body);
  --primary-color: var(--tw-primary);
  --md-char-color: var(--theme-400);
  --meta-content-color: var(--theme-500);
  --typora-source-body: var(--theme-800);
  --heading-char-color: var(--md-char-color);
  --mermaid-theme: neutral;
  --active-toggle-btn-color: var(--theme-200);

  --md-char-color-inverted: var(--theme-500);
  --meta-content-color-inverted: var(--theme-400);
  --typora-source-body-inverted: var(--theme-300);
  --mermaid-theme-inverted: dark;
  --active-toggle-btn-color-inverted: var(--theme-400);

  /* 侧边栏 */
  --side-bar-bg-color: var(--tw-prose-bg);
  --active-file-bg-color: var(--theme-100);
  --active-file-text-color: var(--tw-prose-bold);
  --active-file-border-color: var(--theme-100);
  --panel-border-color: var(--theme-300);
  --blur-text-color: var(--theme-300);
  --window-border: 1px solid var(--theme-200);
  --item-hover-bg-color: var(--theme-100);
  --search-hit-text-bg-color: var(--theme-200);
  --search-hit-text-font-color: inherit;
  --search-select-text-color: var(--select-text-font-color);
  --search-select-bg-color: var(--select-text-bg-color);

  --blur-text-color-inverted: var(--theme-500);
  --panel-border-color-inverted: var(--theme-700);
  --active-file-bg-color-inverted: var(--theme-700);
  --window-border-inverted: 1px solid var(--theme-700);
  --search-hit-text-bg-color-inverted: var(--theme-700);
  --search-hit-text-font-color-inverted: var(--theme-0);
  --search-select-bg-color-inverted: var(--theme-400);
  --rawblock-edit-panel-bd: var(--tw-prose-pre-bg);
  --item-hover-bg-color-inverted: var(--theme-700);

  --monospace: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
    "Liberation Mono", "Courier New", monospace;

  /* 脚注相关 */
  --footnote: var(--tw-prose-body);
  --footnote-bg: #94a3b855;
  --button-bg: var(--theme-200);
  --button-bg-inverted: var(--theme-600);

  /* 表格网格 */
  --md-grid-header: var(--theme-100);
  --md-grid-header-ext: var(--theme-400);
  --md-grid-ext: var(--theme-300);
  --md-grid-header-active: var(--theme-500);
  --md-grid-active: var(--theme-400);
  --md-grid-border-color: var(--theme-500);

  --md-grid-header-inverted: var(--theme-600);
  --md-grid-header-ext-inverted: var(--theme-500);
  --md-grid-ext-inverted: var(--theme-600);
  --md-grid-header-active-inverted: var(--theme-400);
  --md-grid-active-inverted: var(--theme-500);
  --md-grid-border-color-inverted: var(--theme-200);

  --code-blocks-font-size: 0.9em;
  --inline-code-font-size: 0.9em;

  /* DeepWhite 自定义变量 */
  --color-background: #fafbfc;
  --color-text: #333333;
  --color-text-strong: #000000;
  --color-text-subtle: #555555;
  --color-meta: #888888;
  --color-border: #eeeeee;
  --color-link-underline: #bbbbbb;
  --color-code-bg: #f7f7f7;
  --font-family-sans-cjk: "LXGWWenKai-Regular", "霞鹜文楷", "PingFang SC", "Hiragino Sans GB", sans-serif;
  --font-family-mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
  --font-family-heading: "LXGWWenKai-Medium", var(--font-family-sans-cjk);
  --dw-h1-font-size: 2.5em;
  --dw-h1-line-height: 1.2;
  --dw-h1-letter-spacing: -0.02em;
  --dw-h2-font-size: 2em;
  --dw-h2-line-height: 1.3;
  --dw-h2-letter-spacing: -0.01em;
  --dw-h3-font-size: 1.5em;
  --dw-h3-line-height: 1.4;
  --dw-h3-letter-spacing: -0.01em;
  --dw-h4-font-size: 1.25em;
  --dw-h4-line-height: 1.4;
  --dw-h4-letter-spacing-en: 0.08em;
  --dw-heading-underline-color: var(--color-border);
  --dw-heading-underline-thickness: 0.14em;
  --dw-heading-underline-offset: 0.5em;
}

.ty-file-search-match-text {
  background-color: var(--search-hit-text-bg-color);
}

/* =========================
   3. Tailwind Reset
   ========================= */
*,
::before,
::after {
  box-sizing: border-box;
  border-width: 0;
  border-style: solid;
  border-color: currentColor;
}

::before,
::after {
  --tw-content: "";
}

#text {
  line-height: 1.5;
  -webkit-text-size-adjust: 100%;
  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;
}

#text {
  margin: 0;
  line-height: inherit;
}

hr {
  height: 0;
  color: inherit;
  border-top-width: 1px;
}

abbr:where([title]) {
  -webkit-text-decoration: underline dotted;
  text-decoration: underline dotted;
}

h1,
h2,
h3,
h4,
h5,
h6 {
  font-size: inherit;
  font-weight: inherit;
  font-family: "LXGWWenKai-Medium";
}

a {
  color: inherit;
  text-decoration: inherit;
}

b,
strong {
  font-weight: bolder;
}

code,
kbd,
samp,
pre {
  font-family: var(--monospace);
  font-size: 1em;
}

small {
  font-size: 80%;
}

sub,
sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}

sub {
  bottom: -0.25em;
}

sup {
  top: -0.5em;
}

table {
  text-indent: 0;
  border-color: inherit;
  border-collapse: collapse;
}

button,
input,
optgroup,
select,
textarea {
  font-family: inherit;
  font-size: 100%;
  line-height: inherit;
  color: inherit;
  margin: 0;
  padding: 0;
}

blockquote,
dl,
dd,
h1,
h2,
h3,
h4,
h5,
h6,
hr,
figure,
p,
pre {
  margin: 0;
}

fieldset {
  margin: 0;
  padding: 0;
}

legend {
  padding: 0;
}

ol,
ul,
menu {
  list-style: none;
  margin: 0;
  padding: 0;
}

textarea {
  resize: vertical;
}


/* 写作区基础 */
#write {
  font-size: 1.25rem;
  line-height: 1.625rem;
  max-width: 80rem;
}

html,
body {
  font-family: "LXGWWenKai-Regular";
}

content,
titlebar {
  background: var(--tw-prose-bg);
}

#write {
  padding-top: 100px;
  padding-bottom: 100px;
  color: var(--tw-prose-body);
  max-width: 80ch;
}

#write > :where(:first-child) {
  margin-top: 0;
}

#write > :where(:last-child) {
  margin-bottom: 0;
}

/* YAML 元数据 */
pre.md-meta-block {
  color: var(--tw-prose-meta);
  background-color: var(--tw-prose-meta-bg);
  font-weight: 400;
  font-size: var(--code-blocks-font-size);
  line-height: 1.7777778;
  border-radius: 0.5rem;
  padding: 1.1111111em 1.3333333em;
  margin-bottom: 2.8em;
}

/* 标题 - 统一样式 */
#write h1 {
  color: var(--tw-prose-headings);
  font-weight: 800;
  font-size: var(--dw-h1-font-size);
  margin-top: 0;
  margin-bottom: 1.5rem;
  line-height: var(--dw-h1-line-height);
  letter-spacing: var(--dw-h1-letter-spacing);
  text-align: center;
}

#write h1 strong {
  font-weight: 900;
}

#write h2 {
  color: var(--tw-prose-headings);
  font-weight: bold;
  font-size: var(--dw-h2-font-size);
  margin-top: 1.5em;
  margin-bottom: 1rem;
  line-height: var(--dw-h2-line-height);
  letter-spacing: var(--dw-h2-letter-spacing);
  padding-bottom: 0.5em;
  display: block;
  text-decoration: underline;
  text-decoration-color: var(--dw-heading-underline-color);
  text-decoration-thickness: var(--dw-heading-underline-thickness);
  text-underline-offset: var(--dw-heading-underline-offset);
}

#write h2 strong {
  font-weight: 800;
}

#write h3 {
  color: var(--tw-prose-headings);
  font-weight: bold;
  font-size: var(--dw-h3-font-size);
  margin-top: 1.6em;
  margin-bottom: 1rem;
  line-height: var(--dw-h3-line-height);
  letter-spacing: var(--dw-h3-letter-spacing);
  padding-bottom: 0.5em;
  display: block;
  text-decoration: underline;
  text-decoration-color: var(--dw-heading-underline-color);
  text-decoration-thickness: var(--dw-heading-underline-thickness);
  text-underline-offset: var(--dw-heading-underline-offset);
}

#write h3 strong {
  font-weight: 700;
}

#write h4 {
  color: var(--color-text-subtle);
  font-size: var(--dw-h4-font-size);
  font-weight: 600;
  margin-top: 1.8em;
  margin-bottom: 1rem;
  line-height: var(--dw-h4-line-height);
  padding-bottom: 0.5em;
  display: block;
  text-decoration: underline;
  text-decoration-color: var(--dw-heading-underline-color);
  text-decoration-thickness: var(--dw-heading-underline-thickness);
  text-underline-offset: var(--dw-heading-underline-offset);
}

#write h4:lang(en) {
  text-transform: uppercase;
  letter-spacing: var(--dw-h4-letter-spacing-en);
}

#write h4 strong {
  font-weight: 700;
}

#write h2 code {
  font-size: 0.8611111em;
}

#write h3 code {
  font-size: 0.9em;
}

#write h2 + * {
  margin-top: 0;
}

#write h3 + * {
  margin-top: 0;
}

#write h4 + * {
  margin-top: 0;
}

#write h5 {
  font-size: 1.125em;
  line-height: 1.4;
  margin-top: 1.6em;
  margin-bottom: 0.8rem;
  font-weight: bold;
}

#write h6 {
  font-size: 1em;
  line-height: 1.4;
  margin-top: 1.6em;
  margin-bottom: 0.8rem;
  color: var(--color-text-subtle);
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

/* 表格 */
table {
  width: 100%;
  table-layout: auto;
  text-align: left;
  margin-top: 2em;
  margin-bottom: 2em;
  font-size: 0.9em;
  line-height: 1.5555556;
}

thead {
  border-bottom-width: 1px;
  border-bottom-color: var(--tw-prose-th-borders);
  background: #ececec;
}

thead th {
  color: var(--tw-prose-headings);
  font-weight: 600;
  vertical-align: bottom;
  padding-right: 0.6666667em;
  padding-bottom: 0.8888889em;
  padding-left: 0.6666667em;
}

thead th:first-child {
  padding-left: 0;
}

thead th:last-child {
  padding-right: 0;
}

tbody tr {
  border-bottom-width: 1px;
  border-bottom-color: var(--tw-prose-td-borders);
}

tbody tr:last-child {
  border-bottom-width: 0;
}

tbody td {
  vertical-align: baseline;
  padding-top: 0.8888889em;
  padding-right: 0.6666667em;
  padding-bottom: 0.8888889em;
  padding-left: 0.6666667em;
}

tbody td:first-child {
  padding-left: 0;
}

tbody td:last-child {
  padding-right: 0;
}

.md-grid-board tr[row="1"] {
  background-color: var(--md-grid-header);
}

.md-grid-board a:hover,
.md-grid-board a.md-active {
  background: var(--md-grid-active);
}

.md-grid-board tr[row="1"] a:hover,
.md-grid-board tr[row="1"] a.md-active {
  background: var(--md-grid-header-active);
}

.md-grid-board .md-grid-ext {
  background: var(--md-grid-ext);
}

.md-grid-board tr[row="1"] .md-grid-ext {
  background: var(--md-grid-header-ext);
}

.md-grid-board a {
  border-color: var(--md-grid-border-color) !important;
}

/* 列表 */
ol {
  list-style-type: decimal;
  padding-left: 2.6em;
}

li {
  margin-top: 0.6em;
  margin-bottom: 0.6em;
}

ul {
  list-style-type: disc;
  padding-left: 2.6em;
}

#write ul.task-list {
  padding-left: 0;
}

#write li.task-list-item {
  padding-left: 0.4em;
}

#write input[type="checkbox"] {
  margin-left: -1em;
}

input[checked] ~ * {
  opacity: 0.7;
  text-decoration: line-through;
}

ol > li::marker {
  font-weight: 400;
  color: var(--tw-prose-counters);
}

ul > li::marker {
  color: var(--tw-prose-bullets);
}

ul > li,
ol > li {
  padding-left: 0.4em;
}

ul > li p,
ol > li p {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}

#write > ul > li > :not(input):first-child,
#write > ol > li > :not(input):first-child,
#write > ul > li > input + *,
#write > ol > li > input + * {
  margin-top: 1.2em;
}

#write > ul > li > *:last-child,
#write > ol > li > *:last-child {
  margin-bottom: 1.2em;
}

#write ul > li > p:only-child,
#write ol > li > p:only-child,
#write ul > li > input + p:last-child,
#write ol > li > input + p:last-child {
  margin-top: 0;
  margin-bottom: 0;
}

ul ul,
ul ol,
ol ul,
ol ol {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}

/* 引用块 */
blockquote {
  font-weight: 500;
  font-style: italic;
  color: var(--tw-prose-quotes);
  border-left-width: 0.25rem;
  border-left-color: var(--tw-prose-quote-borders);
  quotes: "\201C""\201D""\2018""\2019";
  margin-top: 1.6em;
  margin-bottom: 1.6em;
  padding-left: 1.0666667em;
}

blockquote p:first-of-type::before {
  content: open-quote;
}

blockquote p:last-of-type::after {
  content: close-quote;
}

/* 分隔线 */
hr {
  border-color: var(--tw-prose-hr);
  border-top-width: 1px;
}

[mdtype="hr"] {
  margin-top: 2.8em;
  margin-bottom: 2.8em;
}

p {
  margin-top: 1.2em;
  margin-bottom: 1.2em;
}

.in-text-selection,::selection {
  background-color: var(--select-text-bg-color);
}

/* 图表面板 */
.md-diagram-panel {
  color: var(--tw-prose-body);
}

.enable-diagrams .md-diagram .code-tooltip {
  bottom: -1.9em;
  right: 0;
}

.md-fences-adv-panel {
  margin-top: 1.3em;
}


sup.md-footnote {
  color: var(--footnote);
  background-color: var(--footnote-bg);
}

.footnotes {
  font-size: 0.85em;
}

.md-reverse-footnote-area a {
  font-family: "LXGWWenKai-Regular";
  text-decoration: none;
  color: var(--tw-primary);
  border-radius: 3px;
}

.md-hover-tip .code-tooltip-content {
  font-size: 1.05rem;
  line-height: 1.6;
  padding: 0.8em 1.2em;
}

.md-reverse-footnote-area a:hover {
  background-color: var(--item-hover-bg-color);
}

.md-def-name:before {
  color: var(--md-char-color);
}

.md-rawblock.md-rawblock-on-edit,
.md-rawblock:hover {
  color: var(--tw-prose-pre-code);
}

.md-inline-math script {
  color: var(--tw-prose-code);
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: var(--tw-highlight-color) !important;
}

g[data-mml-node="merror"] > g {
  fill: #000 !important;
  stroke: #000 !important;
}

.code-tooltip {
  color: var(--theme-700);
  background-color: var(--theme-100);
}

.code-tooltip .md-mathjax-preview {
  color: var(--tw-prose-body);
}

.md-htmlblock-container,
.md-rawblock-input.md-rawblock-control,
.md-htmlblock-panel.md-rawblock-control,
.md-math-container {
  border-radius: 0.5rem 0 0.5rem 0.5rem;
}

.md-rawblock-input {
  font-size: var(--code-blocks-font-size);
  padding: 0 1.3333333em;
}

.md-mathblock-panel .md-rawblock-input.md-rawblock-control {
  border-top-color: transparent;
  border-bottom-color: transparent;
  border-radius: 0;
}

.md-mathblock-panel .md-rawblock-before {
  padding-top: 1.1em;
  border-top-left-radius: 0.5rem;
}

.md-mathblock-panel .md-rawblock-after {
  padding-bottom: 1.1em;
  border-bottom-left-radius: 0.5rem;
  border-bottom-right-radius: 0.5rem;
}

.md-htmlblock-panel .md-rawblock-input {
  padding-top: 1.1111111em;
  padding-bottom: 1.1111111em;
}

.md-mathblock-panel .md-rawblock-before,
.md-mathblock-panel .md-rawblock-after {
  font-size: var(--code-blocks-font-size);
  padding-left: calc(4px + 1.3333333em);
  color: var(--code-bracket);
}

.md-rawblock-tooltip {
  color: var(--tw-prose-pre-code);
  border-radius: 0.5rem 0.5rem 0 0;
}

.md-rawblock-tooltip-name {
  opacity: 1;
}

.md-comment {
  font-size: var(--inline-code-font-size);
  color: var(--code-comment);
}

.md-raw-inline,
.md-tag,
[md-inline="linebreak"],
.md-image > .md-meta,
.md-inline-math.md-expand > .md-inline-math-container {
  font-size: var(--code-blocks-font-size);
}

/* 代码块  */
.md-fences {
  color: var(--tw-prose-pre-code);
  background-color: var(--tw-prose-pre-bg);
  font-weight: 400;
  font-size: var(--code-blocks-font-size);
  line-height: 1.7777778;
  margin-top: 2em;
  margin-bottom: 2em;
  border-radius: 0.5rem;
  padding: 1.1111111em 1.3333333em;
}

.md-fences.md-focus {
  border-bottom-right-radius: 0;
}

.md-fences > .code-tooltip {
  height: 1.8rem;
  bottom: -1.8rem;
  font-size: 0.9rem;
  border-radius: 0 0 0.5rem 0.5rem;
  color: var(--theme-700);
  background-color: var(--theme-200);
}

.code-tooltip .ty-input {
  min-width: 10rem;
}

pre code {
  background-color: transparent;
  border-width: 0;
  border-radius: 0;
  padding: 0;
  font-weight: inherit;
  color: inherit;
  font-size: inherit;
  font-family: inherit;
  line-height: inherit;
}

pre code::before {
  content: none;
}

pre code::after {
  content: none;
}

/* 语法高亮 */
:root {
  --code-neutral: var(--theme-800);
  --code-cursor: var(--theme-900);
  --code-string: rgb(14, 165, 233);
  --code-number: rgb(245, 158, 11);
  --code-tag: rgb(236, 72, 153);
  --code-color: rgb(237, 71, 89);
  --code-color-bg: rgb(237, 237, 235);
  --code-variable: var(--theme-700);
  --code-operator: var(--theme-600);
  --code-comment: var(--theme-500);
  --code-bracket: var(--theme-500);
  --code-citation: var(--theme-500);

  --code-neutral-inverted: var(--theme-100);
  --code-cursor-inverted: var(--theme-50);
  --code-string-inverted: #7dd4fc;
  --code-number-inverted: #fde68a;
  --code-tag-inverted: #f472b5;
  --code-variable-inverted: var(--theme-200);
  --code-operator-inverted: var(--theme-400);
  --code-comment-inverted: var(--theme-400);
  --code-bracket-inverted: var(--theme-500);
  --code-citation-inverted: var(--theme-400);
}

/* 代码块内语法高亮 - 使用浅色背景的深色文字 */
.cm-s-inner {
  --code-neutral: var(--theme-800);
  --code-cursor: var(--theme-900);
  --code-string: rgb(14, 165, 233);
  --code-number: rgb(245, 158, 11);
  --code-tag: rgb(236, 72, 153);
  --code-variable: var(--theme-700);
  --code-operator: var(--theme-600);
  --code-comment: var(--theme-500);
  --code-bracket: var(--theme-500);
  --code-citation: var(--theme-500);
}

.CodeMirror-selectedtext {
  background-color: transparent;
}
.CodeMirror-cursor {
  border-left: 1px solid var(--code-cursor) !important;
}
.CodeMirror-gutters {
  border-color: var(--code-comment);
}
.cm-s-inner span.cm-string {
  color: var(--code-string);
}

.cm-s-inner span.cm-number {
  color: var(--code-number);
}

.cm-s-inner span.cm-tag,
.cm-s-inner span.cm-keyword,
.cm-s-inner span.cm-qualifier {
  color: var(--code-tag);
}

.cm-s-inner .CodeMirror-guttermarker,
.cm-s-inner .CodeMirror-guttermarker-subtle,
.cm-s-inner span.cm-comment.cm-def,
.cm-s-inner span.cm-comment.cm-type,
.cm-s-inner span.cm-builtin,
.cm-s-inner span.cm-type,
.cm-s-inner span.cm-header,
.cm-s-inner span.cm-link,
.cm-s-inner span.cm-error {
  background: transparent;
  color: var(--code-neutral);
}

.cm-s-inner span.cm-attribute,
.cm-s-inner span.cm-property,
.cm-s-inner span.cm-variable,
.cm-s-inner span.cm-variable-2,
.cm-s-inner span.cm-variable-3,
.cm-s-inner span.cm-type,
.cm-s-inner span.cm-atom,
.cm-s-inner span.cm-def {
  color: var(--code-variable);
}
.cm-s-inner span.cm-comment,
.cm-s-inner .CodeMirror-linenumber {
  color: var(--code-comment);
}
.cm-s-inner span.cm-operator {
  color: var(--code-operator);
}
.cm-s-inner span.cm-bracket,
.cm-s-inner span.cm-tag.cm-bracket,
.cm-s-inner span.cm-meta {
  color: var(--code-bracket);
}

.cm-s-inner span.cm-link {
  text-decoration: underline;
}

/* 行内元素 */
code {
  color: var(--code-color);
  background-color: var(--code-color-bg);
  border-radius: 0.3rem;
  padding: 0.1rem 0.3rem;
  margin: 0.1rem 0.1rem;
}

code::before {
  content: none;
}

code::after {
  content: none;
}

[md-inline="code"].md-expand > code::before,
[md-inline="code"].md-expand > code::after {
  content: "";
}

a code {
  color: var(--tw-prose-links);
}

mark code {
  color: inherit;
}

strong {
  color: var(--tw-prose-bold);
  font-weight: 600;
}

a {
  color: var(--tw-prose-links);
  text-decoration: underline;
  font-weight: 500;
}

p > .md-image:only-child {
  margin-top: 0.8em !important;
  margin-bottom: 0.8em !important;
}

.md-image > .md-meta {
  color: var(--tw-prose-code);
}

mark {
  border-radius: 3px;
  padding: 0 2px;
  background-color: var(--tw-highlight-color);
}


/* 源码模式 */
.cm-s-typora-default .CodeMirror-activeline-background {
  background-color: var(--item-hover-bg-color);
}

#typora-source {
  font-family: var(--monospace);
  color: var(--typora-source-body);
}

#typora-source .cm-header {
  color: var(--code-tag);
}

#typora-source .cm-link {
  color: var(--code-string);
}

#typora-source .cm-string {
  color: var(--code-string);
}

#typora-source .cm-comment {
  color: var(--code-comment);
}

#typora-source .cm-atom {
  color: var(--code-citation);
}

#typora-source .cm-tag {
  color: var(--code-tag);
}

#typora-source .cm-attribute {
  color: var(--code-variable);
}

#typora-source .cm-bracket {
  color: var(--code-bracket);
}

.file-list-item-file-ext-part {
  opacity: 0.5;
}

#write div.md-toc-tooltip {
  background-color: var(--tw-prose-bg);
}

.md-toc {
  font-size: 0.8em;
}

.md-toc-h1 .md-toc-inner {
  margin-left: 0;
}

.md-toc-h2 .md-toc-inner {
  margin-left: 1em;
}

.md-toc-h3 .md-toc-inner {
  margin-left: 2em;
}

.md-toc-h4 .md-toc-inner {
  margin-left: 3em;
}

.md-toc-h5 .md-toc-inner {
  margin-left: 4em;
}

.md-toc-h6 .md-toc-inner {
  margin-left: 5em;
}

#typora-sidebar {
  border-right: var(--window-border);
}

.sidebar-tab {
  text-transform: none;
  font-weight: 700;
  font-size: 1.1em;
}

.md-search-hit {
  color: var(--search-hit-text-font-color);
  background-color: var(--search-hit-text-bg-color);
}

#md-searchpanel {
  box-shadow: none;
  filter: var(--tw-drop-shadow-md);
}

#md-searchpanel .btn:not(.close-btn):hover {
  box-shadow: none;
  -webkit-box-shadow: none;
  background-color: var(--tw-button-hover-bg);
}

#md-searchpanel input,
#md-searchpanel .btn,
#searchpanel-msg {
  border-radius: 5px;
}

#searchpanel-msg {
  color: var(--theme-500);
  border-color: var(--theme-300);
  background: var(--theme-100);
}

.form-control {
  border-color: var(--panel-border-color);
}

.btn-default {
  background-color: var(--button-bg);
}

/* =========================
   5. DeepWhite 自定义样式
   ========================= */

/* 标题自动编号 */
#write {
  counter-reset: h2;
}

h2 {
  counter-reset: h3;
}

h3 {
  counter-reset: h4;
}

h4 {
  counter-reset: h5;
}

h5 {
  counter-reset: h6;
}

#write h2:before {
  counter-increment: h2;
  content: counter(h2) ". ";
  color: var(--color-text-subtle);
}

#write h3:before,
h3.md-focus.md-heading:before {
  counter-increment: h3;
  content: counter(h2) "." counter(h3) ". ";
  color: var(--color-text-subtle);
}

#write h4:before,
h4.md-focus.md-heading:before {
  counter-increment: h4;
  content: counter(h2) "." counter(h3) "." counter(h4) ". ";
  color: var(--color-text-subtle);
}

#write h5:before,
h5.md-focus.md-heading:before {
  counter-increment: h5;
  content: counter(h2) "." counter(h3) "." counter(h4) "." counter(h5) ". ";
  color: var(--color-text-subtle);
}

#write h6:before,
h6.md-focus.md-heading:before {
  counter-increment: h6;
  content: counter(h2) "." counter(h3) "." counter(h4) "." counter(h5) "." counter(h6) ". ";
  color: var(--color-text-subtle);
}

/* 覆盖聚焦标题的默认样式 */
#write>h3.md-focus:before,
#write>h4.md-focus:before,
#write>h5.md-focus:before,
#write>h6.md-focus:before,
h3.md-focus:before,
h4.md-focus:before,
h5.md-focus:before,
h6.md-focus:before {
  color: inherit;
  border: inherit;
  border-radius: inherit;
  position: inherit;
  left: initial;
  float: none;
  top: initial;
  font-size: inherit;
  padding-left: inherit;
  padding-right: inherit;
  vertical-align: inherit;
  font-weight: inherit;
  line-height: inherit;
}

/* 任务列表圆形复选框 */
#write .md-task-list-item {
  list-style: none !important;
  padding-left: 0 !important;
  display: flex !important;
  align-items: center !important;
  margin: 0.5em 0;
}

#write .md-task-list-item > input {
  margin-right: 0.5rem;
  margin-top: 0 !important;
  cursor: pointer;
  width: 18px;
  height: 18px;
  min-width: 18px;
  min-height: 18px;
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
  border: none;
  border-radius: 50%;
  background-color: #eee;
  position: relative;
  transition: all 0.3s ease;
  outline: none;
  box-shadow: none;
  flex-shrink: 0;
  vertical-align: middle;
}

#write .md-task-list-item > input:focus {
  box-shadow: none;
  outline: none;
}

#write .md-task-list-item > input:hover {
  background-color: #ccc;
}

#write .md-task-list-item > input:checked {
  background-color: #28ca42;
}

#write .md-task-list-item > input:checked::after {
  content: '';
  position: absolute;
  left: 50%;
  top: 50%;
  width: 5px;
  height: 10px;
  border: solid white;
  border-width: 0 2px 2px 0;
  transform: translate(-50%, -60%) rotate(45deg);
}

/* 已完成任务的删除线效果 */
#write .md-task-list-item.task-list-done,
#write .md-task-list-item input[checked] ~ * {
  text-decoration: line-through;
  color: var(--color-text-subtle);
  opacity: 0.7;
}

#write .md-task-list-item input[type="checkbox"]:checked ~ * {
  text-decoration: line-through;
  color: var(--color-text-subtle);
  opacity: 0.7;
}

#write .task-list-done {
  text-decoration: line-through;
  color: var(--color-text-subtle);
  opacity: 0.7;
}


/* 代码块样式 */
#write pre.md-fences {
  margin: 2.4em auto;
  padding: 1.5em 1.6em;
  background: linear-gradient(135deg, #f8f9fa 0%, #f1f3f4 100%);
  border: 1px solid var(--color-border);
  border-radius: 12px;
  overflow-x: auto;
  font-family: var(--font-family-mono);
  font-size: var(--code-blocks-font-size);
  font-weight: 400;
  line-height: 1.7777778;
  tab-size: 2;
  color: var(--theme-800);
}

#write pre.md-fences code {
  background: none;
  padding: 0;
  border-radius: 0;
  border: none;
  color: inherit;
  font-weight: inherit;
  font-size: inherit;
  font-family: inherit;
  line-height: inherit;
}

/* 代码块滚动条 */
#write pre.md-fences::-webkit-scrollbar {
  height: 8px;
}

#write pre.md-fences::-webkit-scrollbar-track {
  background: rgba(0, 0, 0, 0.05);
  border-radius: 4px;
}

#write pre.md-fences::-webkit-scrollbar-thumb {
  background: rgba(0, 0, 0, 0.2);
  border-radius: 4px;
  transition: background 0.2s ease;
}

#write pre.md-fences::-webkit-scrollbar-thumb:hover {
  background: rgba(0, 0, 0, 0.3);
}

/* GitHub 风格警告框 */
#write blockquote[class*="callout"] {
  margin: 2em 0;
  padding: 1em 1.25em;
  border-left: 4px solid;
  border-radius: 6px;
  background: none !important;
  font-style: normal;
  font-weight: normal;
}

#write blockquote.callout-note {
  border-left-color: #0969da !important;
}

#write blockquote.callout-note > p:first-child strong:first-child {
  color: #0969da !important;
}

#write blockquote.callout-tip {
  border-left-color: #1a7f37 !important;
}

#write blockquote.callout-tip > p:first-child strong:first-child {
  color: #1a7f37 !important;
}

#write blockquote.callout-important {
  border-left-color: #8250df !important;
}

#write blockquote.callout-important > p:first-child strong:first-child {
  color: #8250df !important;
}

#write blockquote.callout-warning {
  border-left-color: #9a6700 !important;
}

#write blockquote.callout-warning > p:first-child strong:first-child {
  color: #9a6700 !important;
}

#write blockquote.callout-caution {
  border-left-color: #cf222e !important;
}

#write blockquote.callout-caution > p:first-child strong:first-child {
  color: #cf222e;
}

/* 目录自动编号 */
.md-toc-inner {
  text-decoration: none;
}

.md-toc-content {
  counter-reset: h2toc;
}

.md-toc-h1 {
  margin-left: 0;
  font-size: 1.5rem;
}

.md-toc-h2 {
  font-size: 1.1rem;
  margin-left: 2rem;
  counter-reset: h3toc;
}

.md-toc-h3 {
  margin-left: 3rem;
  font-size: 0.9rem;
  counter-reset: h4toc;
}

.md-toc-h4 {
  margin-left: 4rem;
  font-size: 0.85rem;
  counter-reset: h5toc;
}

.md-toc-h5 {
  margin-left: 5rem;
  font-size: 0.8rem;
  counter-reset: h6toc;
}

.md-toc-h6 {
  margin-left: 6rem;
  font-size: 0.75rem;
}

.md-toc-h2:before {
  color: var(--color-text-subtle);
  counter-increment: h2toc;
  content: counter(h2toc) ". ";
}

.md-toc-h2 .md-toc-inner {
  margin-left: 0;
}

.md-toc-h3:before {
  color: var(--color-text-subtle);
  counter-increment: h3toc;
  content: counter(h2toc) "." counter(h3toc) ". ";
}

.md-toc-h3 .md-toc-inner {
  margin-left: 0;
}

.md-toc-h4:before {
  color: var(--color-text-subtle);
  counter-increment: h4toc;
  content: counter(h2toc) "." counter(h3toc) "." counter(h4toc) ". ";
}

.md-toc-h4 .md-toc-inner {
  margin-left: 0;
}

.md-toc-h5:before {
  color: var(--color-text-subtle);
  counter-increment: h5toc;
  content: counter(h2toc) "." counter(h3toc) "." counter(h4toc) "." counter(h5toc) ". ";
}

.md-toc-h5 .md-toc-inner {
  margin-left: 0;
}

.md-toc-h6:before {
  color: var(--color-text-subtle);
  counter-increment: h6toc;
  content: counter(h2toc) "." counter(h3toc) "." counter(h4toc) "." counter(h5toc) "." counter(h6toc) ". ";
}

.md-toc-h6 .md-toc-inner {
  margin-left: 0;
}

/* 响应式设计 */
@media (max-width: 900px) {
  #write {
    padding: 30px 20px;
  }
}

@media (max-width: 600px) {
  html {
    font-size: 15px;
  }
  
  #write {
    padding: 20px 15px;
    font-size: 17px;
  }
  
  #write h1 {
    font-size: 30px;
  }
  
  #write h2 {
    font-size: 1.4em;
  }
  
  #write h3 {
    font-size: 1.2em;
  }
}

/* 打印样式 */
@media print {
  #write {
    max-width: none;
    padding: 0;
  }
  
  #write h1,
  #write h2,
  #write h3,
  #write h4,
  #write h5,
  #write h6 {
    page-break-after: avoid;
  }
  
  #write pre,
  #write blockquote,
  #write table {
    page-break-inside: avoid;
  }
  
  #write img {
    page-break-inside: avoid;
  }
  
  * {
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
  }
}


/* =========================
   6. DeepWhite 补充样式
   ========================= */

/* 键盘按键 */
#write kbd {
  font-family: var(--font-family-mono);
  border: 1px solid var(--color-border);
  border-radius: 4px;
  padding: 0.1em 0.4em;
  background-color: rgba(0, 0, 0, 0.04);
  font-size: 0.85em;
  box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.1);
}

/* 行内代码 - DeepWhite 样式覆盖 */
#write code {
  font-family: var(--font-family-mono);
  font-size: 0.95em;
  background-color: rgba(0, 0, 0, 0.06);
  padding: 0.15em 0.4em;
  border-radius: 0.35em;
  color: var(--color-text);
}

/* 表格 - DeepWhite 样式覆盖 */
#write table:not(.md-grid-board) {
  width: 100%;
  border-collapse: collapse;
  margin: 0.3em 0;
  font-size: 0.95em;
}

#write th:not(.md-grid-board th),
#write td:not(.md-grid-board td) {
  border: 1px solid var(--color-border);
  padding: 0.8em 1em;
  text-align: left;
  vertical-align: top;
}

#write th:not(.md-grid-board th) {
  background-color: rgba(0, 0, 0, 0.02);
  font-weight: 600;
  color: var(--color-text-strong);
}

#write thead th:not(.md-grid-board thead th) {
  background-color: rgba(0, 0, 0, 0.02);
  font-weight: 600;
}

/* 图片 */
#write img {
  max-width: 100%;
  height: auto;
  display: block;
  margin: 3em auto;
  border-radius: 4px;
}

#write figure {
  margin: 3em auto;
  max-width: 640px;
}

#write figcaption {
  font-size: 14px;
  color: var(--color-meta);
  text-align: center;
  margin-top: 0.8em;
}

/* 数学公式 */
#write .md-math-block {
  margin: 2em 0;
  overflow-x: auto;
}

#write .MathJax_Display {
  margin: 2em 0;
}

/* 定义列表 */
#write dl {
  margin: 1.5em 0;
}

#write dt {
  font-weight: 600;
  color: var(--color-text-strong);
  margin-top: 1em;
  margin-bottom: 0.3em;
}

#write dt:first-child {
  margin-top: 0;
}

#write dd {
  margin-left: 1.5em;
  margin-bottom: 0.5em;
  color: var(--color-text);
}

/* 缩写 */
#write abbr {
  text-decoration: underline;
  text-decoration-style: dotted;
  text-underline-offset: 0.2em;
  cursor: help;
  border-bottom: none;
}

/* Details/Summary 折叠 */
#write details {
  margin: 1.5em 0;
  padding: 1em;
  border: 1px solid var(--color-border);
  border-radius: 6px;
  background-color: var(--color-code-bg);
}

#write details summary {
  cursor: pointer;
  font-weight: 600;
  color: var(--color-text-strong);
  padding: 0.5em 0;
  user-select: none;
  list-style: none;
  position: relative;
  padding-left: 1.5em;
}

#write details summary::-webkit-details-marker {
  display: none;
}

#write details summary::before {
  content: "▶";
  position: absolute;
  left: 0;
  font-size: 0.8em;
  transition: transform 0.2s ease;
  color: var(--color-text-subtle);
}

#write details[open] summary::before {
  transform: rotate(90deg);
}

#write details[open] summary {
  margin-bottom: 0.5em;
}

/* Front Matter (YAML 元数据块)  */
#write pre.md-meta-block {
  padding: 1.2em 1.5em;
  margin: 0 0 2.4em 0;
  background-color: rgba(0, 0, 0, 0.02);
  border: 1px solid var(--color-border);
  border-radius: 8px;
  font-family: var(--font-family-mono);
  font-size: 0.85em;
  line-height: 1.6;
  color: var(--color-text-subtle);
  position: relative;
}

#write pre.md-meta-block::before {
  content: "YAML";
  position: absolute;
  top: -0.5em;
  left: 1em;
  background: var(--color-background);
  color: var(--color-meta);
  font-size: 0.75em;
  font-weight: 600;
  padding: 0.2em 0.5em;
  border-radius: 3px;
  letter-spacing: 0.05em;
  text-transform: uppercase;
}

/* 侧边栏样式 */
#typora-sidebar {
  background: var(--color-background);
}

.sidebar-content {
  background: var(--color-background);
}

.file-list {
  background: var(--color-background);
}

.file-tree {
  background: var(--color-background);
}

.outline-content {
  background: var(--color-background);
}

.search-content {
  background: var(--color-background);
}

.typora-export {
  background: var(--color-background);
}

.sidebar-tab-content {
  background: var(--color-background);
}

/* 文件项悬浮效果 */
.file-node-content:hover .file-node-icon,
.file-node-content:hover .file-node-open-state {
  visibility: visible;
}

.file-node-content:hover {
  color: var(--color-text-strong);
  transition: color 0.2s ease;
}

/* =========================
   7. Mermaid 图表样式
   ========================= */

/* Mermaid 代码块 - 宽图表可突破写作区域 */
#write .md-fences[lang="mermaid"] {
  max-width: none;
  background: transparent !important;
  border: none !important;
  padding: 1.5em 0 !important;
  box-shadow: none !important;
}

/* Mermaid 图表使用主题字体 */
#write .md-fences[lang="mermaid"] svg text {
  font-family: var(--font-family-sans-cjk) !important;
}

/* 去除 Mermaid SVG 容器的背景色和边框 */
#write .md-fences[lang="mermaid"] svg {
  background: transparent !important;
  border: none !important;
}

/* 去除 Mermaid 图表的整体背景矩形 */
#write .md-fences[lang="mermaid"] svg > rect:first-child {
  fill: transparent !important;
  stroke: none !important;
}

/* 去除所有背景层 */
#write .md-fences[lang="mermaid"] svg g.background rect,
#write .md-fences[lang="mermaid"] svg g[class*="background"] rect {
  fill: transparent !important;
  stroke: none !important;
}

/* 保持节点和形状的样式 */
#write .md-fences[lang="mermaid"] svg .node rect,
#write .md-fences[lang="mermaid"] svg .node circle,
#write .md-fences[lang="mermaid"] svg .node ellipse,
#write .md-fences[lang="mermaid"] svg .node polygon,
#write .md-fences[lang="mermaid"] svg .cluster rect {
  fill: #ffffff !important;
  stroke: #d0d0d0 !important;
  stroke-width: 1.5px !important;
}

/* 调整文本颜色以适应主题 */
#write .md-fences[lang="mermaid"] svg .nodeLabel,
#write .md-fences[lang="mermaid"] svg .edgeLabel,
#write .md-fences[lang="mermaid"] svg text {
  fill: var(--color-text) !important;
  color: var(--color-text) !important;
}

/* 调整连接线颜色 */
#write .md-fences[lang="mermaid"] svg .edgePath path,
#write .md-fences[lang="mermaid"] svg .flowchart-link {
  stroke: #999999 !important;
  stroke-width: 1.5px !important;
}

/* 调整箭头颜色 */
#write .md-fences[lang="mermaid"] svg marker path {
  fill: #999999 !important;
  stroke: #999999 !important;
}

