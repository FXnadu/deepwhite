# 如何编写 Typora 主题

## 更新 CSS 变量

如果你想定义字体、颜色或背景，建议覆盖现有的 CSS 变量。常用的有:

```css
:root {
   --bg-color:  #ffffff; /*改变背景色*/
   --text-color: #333333; /*改变文字颜色*/
   --md-char-color: #C7C5C5; /*改变元字符的颜色，例如 markdown 中的"*"*/
   --meta-content-color: #5b808d; /*改变元内容的颜色，例如 markdown 中的图像文本和链接地址*/

   --primary-color: #428bca; /*主按钮的颜色*/
   --primary-btn-border-color: #285e8e;
   --primary-btn-text-color: #fff;

   --window-border: 1px solid #eee; /*边栏等的边框*/

   --active-file-bg-color: #eee; /*文件树或文件列表中当前项的背景色*/
   --active-file-text-color: inherit;
   --active-file-border-color: #777;

   --side-bar-bg-color: var(--bg-color); /*改变边栏颜色*/
   --item-hover-bg-color: rgba(229, 229, 229, 0.59); /*鼠标悬停时控件项的背景，如侧边栏中的菜单*/
   --item-hover-text-color: inherit;
   --monospace: monospace; /*代码的等宽字体*/
}
```

## 概述

如果你想为 Typora 编写一个 CSS 主题，你只需要:

1. 创建一个新的 CSS 文件
2. 编写 CSS 文件
3. 调整/调试 CSS 类和样式

## 基本规则

- 主题 CSS 的文件命名规则：请勿使用大写字母，并将空格替换为 `-`
- 将默认字体大小放入 html 中，然后将 rem 用作 h1 及 p 这类元素的 font-size 属性
- Typora 是基于 Webkit（macOS）及 Chromium（Windows / Linux）创建的，因此请使用 Chrome 及 Safari 支持的 CSS 属性
- CSS 的某些修改可能会导致 Typora 无法按预期工作，因此请尽可能覆盖默认的 CSS 样式然后进行测试

## 一般属性

Typora 的窗口内容是一个网页，因此请在 html 标签中添加 background, font-family 或其他一般属性。

写入区域是一个 id 为 `#write` 的 div 元素，改变 width, height, padding 属性可调整写入区域的大小。

```css
html, body {
  background-color: #fefefe; /*background color of the window and titlebar*/
  font-family: helvetica, sans-serif; /*custom font*/
}

html {
  font-size: 14px; /*default font size*/
}

#write {
  max-width: 90%; /*adjust size of the writing area*/
  font-size: 1rem; /*basic font size*/
  color: #555; /*basic font color*/
}
```

## 块元素

Typora 将所有元素呈现为标准 HTML 输出，例如段落为 `<p>`、表格为 `<table>`、第一级标题为 `<h1>` 等等：

```css
p {...}
h1 {...}
table {...}
table th td {...}
table tr:nth-child(2n) td {...}
```

你可以添加 `#write` 作为祖先选择器，以使样式只适用于写入区域：

```css
/*this will only apply to h4 inside writing area*/
#write h4 {...} 
```

### mdtype 属性对照表

| mdtype值 | 对应 CSS 选择器 | 说明 |
|----------|----------------|------|
| paragraph | p | |
| line | .md-line | 一个段落可以包含一个或多个.md-line |
| heading | h1~h6 | |
| blockquote | blockquote | |
| list (unordered list) | ul li | |
| list (ordered list) | ol li | |
| list (task) | ul.task-list li.task-list-item | |
| toc | .md-toc | |
| fences | pre.md-fences | 代码块 |
| hr | hr | |
| table | table thead tbody th tr td | |

## 内联元素

内联元素也会像大多数解析器那样呈现：

```css
strong {
  font-weight: bold;
}
em {...}
code {...}
a {...}
img {...}
mark {...} /*highlight*/
```

### md-inline 属性对照表

| md-inline值 | 对应 Markdown 语法 | 输出标签 |
|-------------|-------------------|----------|
| plain | plain | span |
| strong | **strong** | strong |
| em | *em* | em |
| code | `code` | code |
| underline | `<u>underline</u>` | u |
| del | ~~del~~ | del |
| footnote | ^1 | sup |
| emoji | :smile: | span |
| inline_math | $x^2$ | span |
| subscript | ~sub~ | sub |
| superscript | ^sup^ | sup |
| highlight | ==highlight== | mark |
| url | http://typora.io | a |
| link | [link](href) | a |
| image | ![img](src) | img |

## 源代码模式

源代码模式由 CodeMirror 驱动，代码块使用 codemirror 主题 `.cm-s-inner`，而在源代码模式下，codemirror 主题是 `.cm-s-typora-default`：

```css
.cm-s-typora-default .cm-header {
  /*styles for h1~h6 in source code mode*/
}
```

## 打印样式

```css
@media print {
    .typora-export * {
        -webkit-print-color-adjust: exact;
    }
    /* add styles here */
}
```

## 调试和测试

### 在 Typora 中测试

- **macOS**: 从帮助菜单中选择启用调试模式，然后从上下文菜单中单击"检查元素"弹出 DevTools
- **Windows/Linux**: 在"视图"菜单下点击"开发者工具"进入